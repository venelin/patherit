<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the heritability of a continuous trait in a phylogenetically linked
population. — estimateH2 • patherit</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">patherit</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/UserGuide.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the heritability of a continuous trait in a phylogenetically linked
population.</h1>
    </div>

    
    <p>This function estimates the broad-sense heritability of a trait
 from trait measurements at the tips of a phylogenetic tree connecting the
 carriers of this trait. By default the function performs a phylogenetic pair
 (PP) analysis, a phylogenetic mixed model fit (PMM) and a phylogenetic
 Ornstein-Uhlenbeck mixed model fit (POUMM) and returns an object of class
 H2Analysis. Use the generic functions summary and plot to see the
 heritability estimates.</p>
    

    <pre class="usage"><span class='fu'>estimateH2</span>(<span class='no'>z</span>, <span class='no'>tree</span>, <span class='kw'>methods</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>PP</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>PMM</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>POUMM</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>z</th>
      <td><p>A numeric vector of length equal to the number of tips in tree
matching their order.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A phylo object.</p></td>
    </tr>
    <tr>
      <th>methods</th>
      <td><p>A named list of logical values and/or lists, specifying each
estimating method. The names of the elements should start with PP, POUMM, or
PMM. For example, specifying <code>methods = list(PP = TRUE, POUMM_1 = TRUE,
POUMM_2 = list(nSamplesMCMC = 1e6), PMM = TRUE)</code> will cause the methods PP
and PMM to be executed with default settings, while the method POUMM will be
executed with a million iterations in each MCMC chain. The values in the
list methods should be either logical or lists. To disable the fit of a
method, simply exclude it from the list or set it to FALSE.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical: should messages be written on the screen at runtime.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an S3 object of class H2Analysis. Use the generic functions summary
 and plot to display the results.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The order of elements in z should match the order of the tips in
 tree. By default the function will run six MCMC chains of length 100,000.
 Without parallelization of the MCMC chains and the likelihood calculation,
 this may take more than 20 minutes to run on a tree of 1000 tips.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mitov, V. and Stadler, T. (2016). The heritability of pathogen
traits - definitions and estimators. bioRxiv, 058503 doi:
https://doi.org/10.1101/058503</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='PP.html'>PP</a></code>, <code><a href='http://www.rdocumentation.org/packages/POUMM/topics/POUMM'>POUMM::POUMM</a></code>,
 <code><a href='http://www.rdocumentation.org/packages/POUMM/topics/specPOUMM'>POUMM::specifyPOUMM</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Please, read the package vignette for more detailed examples.</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>
<span class='no'>tr</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/rtree'>rtree</a></span>(<span class='no'>N</span>)
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>POUMM</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/POUMM/topics/rVNodesGivenTreePOUMM'>rVNodesGivenTreePOUMM</a></span>(<span class='no'>tr</span>, <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)[<span class='fl'>1</span>:<span class='no'>N</span>]

<span class='co'># Enable parallel execution of the POUMM and PMM chains</span>
<span class='no'>cluster</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/makeCluster'>makeCluster</a></span>(<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>(<span class='kw'>logical</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))
<span class='kw pkg'>doParallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/doParallel/topics/registerDoParallel'>registerDoParallel</a></span>(<span class='no'>cluster</span>)

<span class='no'>H2Analysis</span> <span class='kw'>&lt;-</span> <span class='fu'>estimateH2</span>(<span class='no'>z</span>, <span class='no'>tree</span>)

<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/makeCluster'>stopCluster</a></span>(<span class='no'>cluster</span>)

<span class='fu'>summary</span>(<span class='no'>H2Analysis</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
